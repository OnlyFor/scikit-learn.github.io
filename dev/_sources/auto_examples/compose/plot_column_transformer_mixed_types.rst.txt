
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/compose/plot_column_transformer_mixed_types.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_compose_plot_column_transformer_mixed_types.py>`
        to download the full example code or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_compose_plot_column_transformer_mixed_types.py:


===================================
Column Transformer with Mixed Types
===================================

.. currentmodule:: sklearn

This example illustrates how to apply different preprocessing and feature
extraction pipelines to different subsets of features, using
:class:`~compose.ColumnTransformer`. This is particularly handy for the
case of datasets that contain heterogeneous data types, since we may want to
scale the numeric features and one-hot encode the categorical ones.

In this example, the numeric data is standard-scaled after mean-imputation,
while the categorical data is one-hot encoded after imputing missing values
with a new category (``'missing'``).

In addition, we show two different ways to dispatch the columns to the
particular pre-processor: by column names and by column data types.

Finally, the preprocessing pipeline is integrated in a full prediction pipeline
using :class:`~pipeline.Pipeline`, together with a simple classification
model.

.. GENERATED FROM PYTHON SOURCE LINES 26-31

.. code-block:: default


    # Author: Pedro Morales <part.morales@gmail.com>
    #
    # License: BSD 3 clause








.. GENERATED FROM PYTHON SOURCE LINES 32-44

.. code-block:: default

    import numpy as np

    from sklearn.compose import ColumnTransformer
    from sklearn.datasets import fetch_openml
    from sklearn.pipeline import Pipeline
    from sklearn.impute import SimpleImputer
    from sklearn.preprocessing import StandardScaler, OneHotEncoder
    from sklearn.linear_model import LogisticRegression
    from sklearn.model_selection import train_test_split, GridSearchCV

    np.random.seed(0)








.. GENERATED FROM PYTHON SOURCE LINES 45-46

Load data from https://www.openml.org/d/40945

.. GENERATED FROM PYTHON SOURCE LINES 46-52

.. code-block:: default

    X, y = fetch_openml("titanic", version=1, as_frame=True, return_X_y=True)

    # Alternatively X and y can be obtained directly from the frame attribute:
    # X = titanic.frame.drop('survived', axis=1)
    # y = titanic.frame['survived']








.. GENERATED FROM PYTHON SOURCE LINES 53-71

Use ``ColumnTransformer`` by selecting column by names

We will train our classifier with the following features:

Numeric Features:

* ``age``: float;
* ``fare``: float.

Categorical Features:

* ``embarked``: categories encoded as strings ``{'C', 'S', 'Q'}``;
* ``sex``: categories encoded as strings ``{'female', 'male'}``;
* ``pclass``: ordinal integers ``{1, 2, 3}``.

We create the preprocessing pipelines for both numeric and categorical data.
Note that ``pclass`` could either be treated as a categorical or numeric
feature.

.. GENERATED FROM PYTHON SOURCE LINES 71-87

.. code-block:: default


    numeric_features = ["age", "fare"]
    numeric_transformer = Pipeline(
        steps=[("imputer", SimpleImputer(strategy="median")), ("scaler", StandardScaler())]
    )

    categorical_features = ["embarked", "sex", "pclass"]
    categorical_transformer = OneHotEncoder(handle_unknown="ignore")

    preprocessor = ColumnTransformer(
        transformers=[
            ("num", numeric_transformer, numeric_features),
            ("cat", categorical_transformer, categorical_features),
        ]
    )








.. GENERATED FROM PYTHON SOURCE LINES 88-90

Append classifier to preprocessing pipeline.
Now we have a full prediction pipeline.

.. GENERATED FROM PYTHON SOURCE LINES 90-99

.. code-block:: default

    clf = Pipeline(
        steps=[("preprocessor", preprocessor), ("classifier", LogisticRegression())]
    )

    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

    clf.fit(X_train, y_train)
    print("model score: %.3f" % clf.score(X_test, y_test))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    model score: 0.790




.. GENERATED FROM PYTHON SOURCE LINES 100-104

HTML representation of ``Pipeline`` (display diagram)

When the ``Pipeline`` is printed out in a jupyter notebook an HTML
representation of the estimator is displayed:

.. GENERATED FROM PYTHON SOURCE LINES 104-106

.. code-block:: default

    clf






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style>#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d {color: black;background-color: white;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d pre{padding: 0;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-toggleable {background-color: white;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-estimator:hover {background-color: #d4ebff;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-item {z-index: 1;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-parallel-item:only-child::after {width: 0;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-77fc826d-ac9c-4dc1-84af-708539d0e21d div.sk-text-repr-fallback {display: none;}</style><div id="sk-77fc826d-ac9c-4dc1-84af-708539d0e21d" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                     ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                      Pipeline(steps=[(&#x27;imputer&#x27;,
                                                                       SimpleImputer(strategy=&#x27;median&#x27;)),
                                                                      (&#x27;scaler&#x27;,
                                                                       StandardScaler())]),
                                                      [&#x27;age&#x27;, &#x27;fare&#x27;]),
                                                     (&#x27;cat&#x27;,
                                                      OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                                      [&#x27;embarked&#x27;, &#x27;sex&#x27;,
                                                       &#x27;pclass&#x27;])])),
                    (&#x27;classifier&#x27;, LogisticRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="c8a19f67-2741-4ab3-89f8-0f538007b937" type="checkbox" ><label for="c8a19f67-2741-4ab3-89f8-0f538007b937" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                     ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                      Pipeline(steps=[(&#x27;imputer&#x27;,
                                                                       SimpleImputer(strategy=&#x27;median&#x27;)),
                                                                      (&#x27;scaler&#x27;,
                                                                       StandardScaler())]),
                                                      [&#x27;age&#x27;, &#x27;fare&#x27;]),
                                                     (&#x27;cat&#x27;,
                                                      OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                                      [&#x27;embarked&#x27;, &#x27;sex&#x27;,
                                                       &#x27;pclass&#x27;])])),
                    (&#x27;classifier&#x27;, LogisticRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="d1f66f2f-b554-4e3b-a1b1-3e85af47e98c" type="checkbox" ><label for="d1f66f2f-b554-4e3b-a1b1-3e85af47e98c" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                     Pipeline(steps=[(&#x27;imputer&#x27;,
                                                      SimpleImputer(strategy=&#x27;median&#x27;)),
                                                     (&#x27;scaler&#x27;, StandardScaler())]),
                                     [&#x27;age&#x27;, &#x27;fare&#x27;]),
                                    (&#x27;cat&#x27;, OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                     [&#x27;embarked&#x27;, &#x27;sex&#x27;, &#x27;pclass&#x27;])])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="cce5e6e2-a978-48e7-bb5d-00bea0210c18" type="checkbox" ><label for="cce5e6e2-a978-48e7-bb5d-00bea0210c18" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>[&#x27;age&#x27;, &#x27;fare&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="bbf3a5e9-e956-4874-a269-072e571048c6" type="checkbox" ><label for="bbf3a5e9-e956-4874-a269-072e571048c6" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;median&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="5972275a-f6c8-41b1-b0a2-dcc7b92666f1" type="checkbox" ><label for="5972275a-f6c8-41b1-b0a2-dcc7b92666f1" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="0b0757c0-9f5c-4b0c-b03a-c5b4a8c8f124" type="checkbox" ><label for="0b0757c0-9f5c-4b0c-b03a-c5b4a8c8f124" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>[&#x27;embarked&#x27;, &#x27;sex&#x27;, &#x27;pclass&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="b5baa427-b124-4ba1-aace-7735e5ebc733" type="checkbox" ><label for="b5baa427-b124-4ba1-aace-7735e5ebc733" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="8135dc23-edc3-42a9-b77c-7c036fb07f18" type="checkbox" ><label for="8135dc23-edc3-42a9-b77c-7c036fb07f18" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 107-115

Use ``ColumnTransformer`` by selecting column by data types

When dealing with a cleaned dataset, the preprocessing can be automatic by
using the data types of the column to decide whether to treat a column as a
numerical or categorical feature.
:func:`sklearn.compose.make_column_selector` gives this possibility.
First, let's only select a subset of columns to simplify our
example.

.. GENERATED FROM PYTHON SOURCE LINES 115-119

.. code-block:: default


    subset_feature = ["embarked", "sex", "pclass", "age", "fare"]
    X_train, X_test = X_train[subset_feature], X_test[subset_feature]








.. GENERATED FROM PYTHON SOURCE LINES 120-121

Then, we introspect the information regarding each column data type.

.. GENERATED FROM PYTHON SOURCE LINES 121-124

.. code-block:: default


    X_train.info()





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 1047 entries, 1118 to 684
    Data columns (total 5 columns):
     #   Column    Non-Null Count  Dtype   
    ---  ------    --------------  -----   
     0   embarked  1045 non-null   category
     1   sex       1047 non-null   category
     2   pclass    1047 non-null   float64 
     3   age       841 non-null    float64 
     4   fare      1046 non-null   float64 
    dtypes: category(2), float64(3)
    memory usage: 35.0 KB




.. GENERATED FROM PYTHON SOURCE LINES 125-130

We can observe that the `embarked` and `sex` columns were tagged as
`category` columns when loading the data with ``fetch_openml``. Therefore, we
can use this information to dispatch the categorical columns to the
``categorical_transformer`` and the remaining columns to the
``numerical_transformer``.

.. GENERATED FROM PYTHON SOURCE LINES 132-137

.. note:: In practice, you will have to handle yourself the column data type.
   If you want some columns to be considered as `category`, you will have to
   convert them into categorical columns. If you are using pandas, you can
   refer to their documentation regarding `Categorical data
   <https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html>`_.

.. GENERATED FROM PYTHON SOURCE LINES 137-155

.. code-block:: default


    from sklearn.compose import make_column_selector as selector

    preprocessor = ColumnTransformer(
        transformers=[
            ("num", numeric_transformer, selector(dtype_exclude="category")),
            ("cat", categorical_transformer, selector(dtype_include="category")),
        ]
    )
    clf = Pipeline(
        steps=[("preprocessor", preprocessor), ("classifier", LogisticRegression())]
    )


    clf.fit(X_train, y_train)
    print("model score: %.3f" % clf.score(X_test, y_test))
    clf





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    model score: 0.794


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style>#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 {color: black;background-color: white;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 pre{padding: 0;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-toggleable {background-color: white;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-estimator:hover {background-color: #d4ebff;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-item {z-index: 1;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-parallel-item:only-child::after {width: 0;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88 div.sk-text-repr-fallback {display: none;}</style><div id="sk-0caa607a-2d1a-46bf-be5d-cb3fcd41ff88" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                     ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                      Pipeline(steps=[(&#x27;imputer&#x27;,
                                                                       SimpleImputer(strategy=&#x27;median&#x27;)),
                                                                      (&#x27;scaler&#x27;,
                                                                       StandardScaler())]),
                                                      &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;),
                                                     (&#x27;cat&#x27;,
                                                      OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                                      &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;)])),
                    (&#x27;classifier&#x27;, LogisticRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="1d1fa485-5358-47bf-b9ee-d702b896f5e2" type="checkbox" ><label for="1d1fa485-5358-47bf-b9ee-d702b896f5e2" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                     ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                      Pipeline(steps=[(&#x27;imputer&#x27;,
                                                                       SimpleImputer(strategy=&#x27;median&#x27;)),
                                                                      (&#x27;scaler&#x27;,
                                                                       StandardScaler())]),
                                                      &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;),
                                                     (&#x27;cat&#x27;,
                                                      OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                                      &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;)])),
                    (&#x27;classifier&#x27;, LogisticRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="d98432ad-ea04-45a4-99d9-e9bb10c09cf8" type="checkbox" ><label for="d98432ad-ea04-45a4-99d9-e9bb10c09cf8" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                     Pipeline(steps=[(&#x27;imputer&#x27;,
                                                      SimpleImputer(strategy=&#x27;median&#x27;)),
                                                     (&#x27;scaler&#x27;, StandardScaler())]),
                                     &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;),
                                    (&#x27;cat&#x27;, OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                     &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;)])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="935f0e5f-323e-49e3-8bb7-c0cb73166354" type="checkbox" ><label for="935f0e5f-323e-49e3-8bb7-c0cb73166354" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="c552ee81-1b2e-463c-959a-0fa59e927ef9" type="checkbox" ><label for="c552ee81-1b2e-463c-959a-0fa59e927ef9" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;median&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="506fa3c1-dce8-4b9e-9a2a-9e6a56e84170" type="checkbox" ><label for="506fa3c1-dce8-4b9e-9a2a-9e6a56e84170" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="e162fe07-ad98-463d-81d6-c3dad3080b7f" type="checkbox" ><label for="e162fe07-ad98-463d-81d6-c3dad3080b7f" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="c3f6ed64-b7a7-4fb6-85d2-1afa618b6dc3" type="checkbox" ><label for="c3f6ed64-b7a7-4fb6-85d2-1afa618b6dc3" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="2ebaaeb8-9444-45b8-bb9c-f2db64fc71f1" type="checkbox" ><label for="2ebaaeb8-9444-45b8-bb9c-f2db64fc71f1" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 156-159

The resulting score is not exactly the same as the one from the previous
pipeline because the dtype-based selector treats the ``pclass`` column as
a numeric feature instead of a categorical feature as previously:

.. GENERATED FROM PYTHON SOURCE LINES 159-162

.. code-block:: default


    selector(dtype_exclude="category")(X_train)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    ['pclass', 'age', 'fare']



.. GENERATED FROM PYTHON SOURCE LINES 163-166

.. code-block:: default


    selector(dtype_include="category")(X_train)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    ['embarked', 'sex']



.. GENERATED FROM PYTHON SOURCE LINES 167-175

Using the prediction pipeline in a grid search

Grid search can also be performed on the different preprocessing steps
defined in the ``ColumnTransformer`` object, together with the classifier's
hyperparameters as part of the ``Pipeline``.
We will search for both the imputer strategy of the numeric preprocessing
and the regularization parameter of the logistic regression using
:class:`~sklearn.model_selection.GridSearchCV`.

.. GENERATED FROM PYTHON SOURCE LINES 175-184

.. code-block:: default


    param_grid = {
        "preprocessor__num__imputer__strategy": ["mean", "median"],
        "classifier__C": [0.1, 1.0, 10, 100],
    }

    grid_search = GridSearchCV(clf, param_grid, cv=10)
    grid_search






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style>#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 {color: black;background-color: white;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 pre{padding: 0;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-toggleable {background-color: white;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-estimator:hover {background-color: #d4ebff;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-item {z-index: 1;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-parallel::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-parallel-item:only-child::after {width: 0;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;position: relative;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-f3d4f2d7-d551-4430-8192-24c9563a55d9 div.sk-text-repr-fallback {display: none;}</style><div id="sk-f3d4f2d7-d551-4430-8192-24c9563a55d9" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=10,
                 estimator=Pipeline(steps=[(&#x27;preprocessor&#x27;,
                                            ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                                             Pipeline(steps=[(&#x27;imputer&#x27;,
                                                                                              SimpleImputer(strategy=&#x27;median&#x27;)),
                                                                                             (&#x27;scaler&#x27;,
                                                                                              StandardScaler())]),
                                                                             &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;),
                                                                            (&#x27;cat&#x27;,
                                                                             OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                                                             &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;)])),
                                           (&#x27;classifier&#x27;, LogisticRegression())]),
                 param_grid={&#x27;classifier__C&#x27;: [0.1, 1.0, 10, 100],
                             &#x27;preprocessor__num__imputer__strategy&#x27;: [&#x27;mean&#x27;,
                                                                      &#x27;median&#x27;]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="7e828483-0c92-44d3-a85c-a6ac7ec2b443" type="checkbox" ><label for="7e828483-0c92-44d3-a85c-a6ac7ec2b443" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=10,
                 estimator=Pipeline(steps=[(&#x27;preprocessor&#x27;,
                                            ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                                             Pipeline(steps=[(&#x27;imputer&#x27;,
                                                                                              SimpleImputer(strategy=&#x27;median&#x27;)),
                                                                                             (&#x27;scaler&#x27;,
                                                                                              StandardScaler())]),
                                                                             &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;),
                                                                            (&#x27;cat&#x27;,
                                                                             OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                                                             &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;)])),
                                           (&#x27;classifier&#x27;, LogisticRegression())]),
                 param_grid={&#x27;classifier__C&#x27;: [0.1, 1.0, 10, 100],
                             &#x27;preprocessor__num__imputer__strategy&#x27;: [&#x27;mean&#x27;,
                                                                      &#x27;median&#x27;]})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="92c136c1-6c1f-47ff-924d-05ed6624e0aa" type="checkbox" ><label for="92c136c1-6c1f-47ff-924d-05ed6624e0aa" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;preprocessor&#x27;,
                     ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                                      Pipeline(steps=[(&#x27;imputer&#x27;,
                                                                       SimpleImputer(strategy=&#x27;median&#x27;)),
                                                                      (&#x27;scaler&#x27;,
                                                                       StandardScaler())]),
                                                      &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;),
                                                     (&#x27;cat&#x27;,
                                                      OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                                      &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;)])),
                    (&#x27;classifier&#x27;, LogisticRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="1ba3788d-5746-466a-bbf8-135df4e11e88" type="checkbox" ><label for="1ba3788d-5746-466a-bbf8-135df4e11e88" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessor: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;,
                                     Pipeline(steps=[(&#x27;imputer&#x27;,
                                                      SimpleImputer(strategy=&#x27;median&#x27;)),
                                                     (&#x27;scaler&#x27;, StandardScaler())]),
                                     &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;),
                                    (&#x27;cat&#x27;, OneHotEncoder(handle_unknown=&#x27;ignore&#x27;),
                                     &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;)])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="8fce88e9-61da-44d3-a9b8-14060a3e6133" type="checkbox" ><label for="8fce88e9-61da-44d3-a9b8-14060a3e6133" class="sk-toggleable__label sk-toggleable__label-arrow">num</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312370&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="247dd241-4c81-486b-91c7-1f6faaf1def2" type="checkbox" ><label for="247dd241-4c81-486b-91c7-1f6faaf1def2" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy=&#x27;median&#x27;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="ba7d9572-6d52-46a7-9fbc-389eece02c79" type="checkbox" ><label for="ba7d9572-6d52-46a7-9fbc-389eece02c79" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="8e1a0ab9-d1c8-47d9-ba70-b18c19dd7cb1" type="checkbox" ><label for="8e1a0ab9-d1c8-47d9-ba70-b18c19dd7cb1" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f25d2312250&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="3fc7afe0-7da4-41f7-8b6d-ace1057b07ad" type="checkbox" ><label for="3fc7afe0-7da4-41f7-8b6d-ace1057b07ad" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown=&#x27;ignore&#x27;)</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="f6ec002b-83ec-4715-8353-e015c18a1341" type="checkbox" ><label for="f6ec002b-83ec-4715-8353-e015c18a1341" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 185-188

Calling 'fit' triggers the cross-validated search for the best
hyper-parameters combination:


.. GENERATED FROM PYTHON SOURCE LINES 188-193

.. code-block:: default

    grid_search.fit(X_train, y_train)

    print("Best params:")
    print(grid_search.best_params_)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Best params:
    {'classifier__C': 0.1, 'preprocessor__num__imputer__strategy': 'mean'}




.. GENERATED FROM PYTHON SOURCE LINES 194-195

The internal cross-validation scores obtained by those parameters is:

.. GENERATED FROM PYTHON SOURCE LINES 195-197

.. code-block:: default

    print(f"Internal CV score: {grid_search.best_score_:.3f}")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Internal CV score: 0.784




.. GENERATED FROM PYTHON SOURCE LINES 198-199

We can also introspect the top grid search results as a pandas dataframe:

.. GENERATED FROM PYTHON SOURCE LINES 199-212

.. code-block:: default

    import pandas as pd

    cv_results = pd.DataFrame(grid_search.cv_results_)
    cv_results = cv_results.sort_values("mean_test_score", ascending=False)
    cv_results[
        [
            "mean_test_score",
            "std_test_score",
            "param_preprocessor__num__imputer__strategy",
            "param_classifier__C",
        ]
    ].head(5)






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>mean_test_score</th>
          <th>std_test_score</th>
          <th>param_preprocessor__num__imputer__strategy</th>
          <th>param_classifier__C</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>0.784167</td>
          <td>0.035824</td>
          <td>mean</td>
          <td>0.1</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0.780366</td>
          <td>0.032722</td>
          <td>mean</td>
          <td>1.0</td>
        </tr>
        <tr>
          <th>1</th>
          <td>0.780348</td>
          <td>0.037245</td>
          <td>median</td>
          <td>0.1</td>
        </tr>
        <tr>
          <th>4</th>
          <td>0.779414</td>
          <td>0.033105</td>
          <td>mean</td>
          <td>10</td>
        </tr>
        <tr>
          <th>6</th>
          <td>0.779414</td>
          <td>0.033105</td>
          <td>mean</td>
          <td>100</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 213-217

The best hyper-parameters have be used to re-fit a final model on the full
training set. We can evaluate that final model on held out test data that was
not used for hyperparameter tuning.


.. GENERATED FROM PYTHON SOURCE LINES 217-223

.. code-block:: default

    print(
        (
            "best logistic regression from grid search: %.3f"
            % grid_search.score(X_test, y_test)
        )
    )




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    best logistic regression from grid search: 0.794





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.428 seconds)


.. _sphx_glr_download_auto_examples_compose_plot_column_transformer_mixed_types.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example


  .. container:: binder-badge

    .. image:: images/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/scikit-learn/scikit-learn/main?urlpath=lab/tree/notebooks/auto_examples/compose/plot_column_transformer_mixed_types.ipynb
      :alt: Launch binder
      :width: 150 px


  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_column_transformer_mixed_types.py <plot_column_transformer_mixed_types.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_column_transformer_mixed_types.ipynb <plot_column_transformer_mixed_types.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
